{% extends 'kaliningrad_routes.html' %}

{% block content %}
<div class="profile-full-container">
    <div class="container-fluid vh-100 p-4">
        <div class="card h-100">
            <!-- Хедер с кнопкой закрытия -->
            <div class="card-header d-flex justify-content-between align-items-center">
                <h2 class="mb-0">Профиль пользователя</h2>
                <button onclick="window.history.back()" class="btn btn-danger">
                    <i class="bi bi-x-lg"></i> Закрыть
                </button>
            </div>

            <!-- Тело профиля -->
            <div class="card-body overflow-auto">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}

                    <div class="row g-4">
                        <!-- Левая колонка - аватар -->
                        <div class="col-lg-3">
                            <div class="sticky-top" style="top: 1rem;">
                                <div class="avatar-upload">
                                    {% if user.avatar %}
                                        <img src="{{ user.avatar.url }}"
                                             class="img-fluid rounded-circle mb-3"
                                             alt="Аватар"
                                             style="width: 200px; height: 200px; object-fit: cover;">
                                    {% else %}
                                        <div class="dummy-avatar rounded-circle mb-3">
                                            <i class="bi bi-person fs-1"></i>
                                        </div>
                                    {% endif %}
                                    <input type="file"
                                           name="avatar"
                                           class="form-control"
                                           accept="image/*"
                                           id="avatarInput">
                                    <label for="avatarInput"
                                           class="btn btn-outline-primary mt-2 w-100">
                                        Сменить фото
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Правая колонка - данные -->
                        <div class="col-lg-9">
                            <div class="row g-3">
                                <!-- Поля формы -->
                                <div class="col-md-6">
                                    <label class="form-label">Имя</label>
                                    <input type="text"
                                           name="first_name"
                                           value="{{ user.first_name }}"
                                           class="form-control"
                                           placeholder="Введите имя">
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label">Фамилия</label>
                                    <input type="text"
                                           name="last_name"
                                           value="{{ user.last_name }}"
                                           class="form-control"
                                           placeholder="Введите фамилию">
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label">Email</label>
                                    <input type="email"
                                           value="{{ user.email }}"
                                           class="form-control"
                                           disabled
                                           style="cursor: not-allowed;">
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label">Телефон</label>
                                    <input type="tel"
                                           name="phone"
                                           value="{{ user.phone }}"
                                           class="form-control"
                                           pattern="\+?[0-9\s\-]+"
                                           placeholder="+7 (999) 999-99-99">
                                </div>

                                <div class="col-12">
                                    <label class="form-label">Страна</label>
                                    <input type="text"
                                           name="country"
                                           value="{{ user.country }}"
                                           class="form-control"
                                           placeholder="Введите страну">
                                </div>

                                <!-- Кнопка сохранения -->
                                <div class="col-12 mt-4">
                                    <button type="submit"
                                            class="btn btn-primary px-5 py-2">
                                        <i class="bi bi-save me-2"></i>
                                        Сохранить изменения
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
.profile-full-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1050;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(5px);
}

.dummy-avatar {
    width: 200px;
    height: 200px;
    background: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px dashed #dee2e6;
}

.map-container {
    display: none; /* Скрываем карту при открытом профиле */
}

.card {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    border: none;
}
</style>
{% endblock %}